(window.webpackJsonp=window.webpackJsonp||[]).push([[81],{159:function(e,t,a){"use strict";a.r(t),a.d(t,"frontMatter",(function(){return l})),a.d(t,"metadata",(function(){return c})),a.d(t,"toc",(function(){return d})),a.d(t,"default",(function(){return p}));var n=a(3),r=a(7),i=(a(0),a(214)),s=a(222),o=a(223),l=(a(215),{id:"use-typed-odata-v2-client-in-sap-cloud-sdk-for-java",title:"Typed Client To Consume OData v2 Services",hide_title:!1,hide_table_of_contents:!1,sidebar_label:"OData v2 Typed Client",description:"Use SAP Cloud SDK for Java to build and run OData v2 requests in a type-safe way.",keywords:["sap","cloud","sdk","odata","java","VDM","generate"]}),c={unversionedId:"java/features/odata/use-typed-odata-v2-client-in-sap-cloud-sdk-for-java",id:"java/features/odata/use-typed-odata-v2-client-in-sap-cloud-sdk-for-java",isDocsHomePage:!1,title:"Typed Client To Consume OData v2 Services",description:"Use SAP Cloud SDK for Java to build and run OData v2 requests in a type-safe way.",source:"@site/docs/java/features/odata/type-safe-client-odata-v2.mdx",slug:"/java/features/odata/use-typed-odata-v2-client-in-sap-cloud-sdk-for-java",permalink:"/cloud-sdk/docs/java/features/odata/use-typed-odata-v2-client-in-sap-cloud-sdk-for-java",editUrl:"https://github.com/SAP/cloud-sdk/edit/main/docs/java/features/odata/type-safe-client-odata-v2.mdx",version:"current",lastUpdatedBy:"dependabot[bot]",lastUpdatedAt:1616540596,formattedLastUpdatedAt:"3/23/2021",sidebar_label:"OData v2 Typed Client",sidebar:"someSidebar",previous:{title:"Generate a Typed OData Client With the OData Generator",permalink:"/cloud-sdk/docs/java/features/odata/generate-typed-odata-v2-and-v4-client-for-java"},next:{title:"Typed Client To Consume OData v4 Services",permalink:"/cloud-sdk/docs/java/features/odata/use-typed-odata-v4-client-in-sap-cloud-sdk-for-java"}},d=[{value:"Build and Execute OData Requests With the Typed OData Client",id:"build-and-execute-odata-requests-with-the-typed-odata-client",children:[]},{value:"Versions of OData v2 Client",id:"versions-of-odata-v2-client",children:[{value:"The New Improved Client",id:"the-new-improved-client",children:[]},{value:"The Deprecated Old Client",id:"the-deprecated-old-client",children:[]},{value:"Which One to Choose?",id:"which-one-to-choose",children:[]}]},{value:"Using the Fluent API",id:"using-the-fluent-api",children:[]},{value:"OData Features",id:"odata-features",children:[{value:"Basic CRUD Operations",id:"basic-crud-operations",children:[]},{value:"Select",id:"select",children:[]},{value:"Filter",id:"filter",children:[]},{value:"Batch Requests",id:"batch-requests",children:[]}]},{value:"Entity Update Strategies",id:"entity-update-strategies",children:[]},{value:"Error Handling",id:"error-handling",children:[]},{value:"Navigation Properties",id:"navigation-properties",children:[]},{value:"Server-Driven Paging",id:"server-driven-paging",children:[]},{value:"Switch to Improved OData v2 Type-Safe Client",id:"switch-to-improved-odata-v2-type-safe-client",children:[]}],b={toc:d};function p(e){var t=e.components,a=Object(r.a)(e,["components"]);return Object(i.b)("wrapper",Object(n.a)({},b,a,{components:t,mdxType:"MDXLayout"}),Object(i.b)("h2",{id:"build-and-execute-odata-requests-with-the-typed-odata-client"},"Build and Execute OData Requests With the Typed OData Client"),Object(i.b)("p",null,"The typed OData v2 client allows to build type-safe OData v2 requests for a given service.\nThe Java classes represent the ",Object(i.b)("em",{parentName:"p"},"data model")," and the available ",Object(i.b)("em",{parentName:"p"},"operations")," of the service.\nAs a consequence all requests that are built through the typed OData v2 client are not only ",Object(i.b)("em",{parentName:"p"},"syntactically valid")," but also ",Object(i.b)("em",{parentName:"p"},"semantically valid"),"."),Object(i.b)("h2",{id:"versions-of-odata-v2-client"},"Versions of OData v2 Client"),Object(i.b)("p",null,"The SAP Cloud SDK has two versions of type-safe OData v2 client."),Object(i.b)("div",{className:"admonition admonition-tip alert alert--success"},Object(i.b)("div",{parentName:"div",className:"admonition-heading"},Object(i.b)("h5",{parentName:"div"},Object(i.b)("span",{parentName:"h5",className:"admonition-icon"},Object(i.b)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},Object(i.b)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"use Tabs to see the API difference")),Object(i.b)("div",{parentName:"div",className:"admonition-content"},Object(i.b)("p",{parentName:"div"},"SAP Cloud SDK ",Object(i.b)("inlineCode",{parentName:"p"},"3.29.1")," releases the productive version of the new, improved OData client.\nConsequently, the APIs of the old OData client have been deprecated."))),Object(i.b)("h3",{id:"the-new-improved-client"},"The New Improved Client"),Object(i.b)("p",null,"As of SAP Cloud SDK ",Object(i.b)("inlineCode",{parentName:"p"},"3.29.1")," we offer a generally available improved OData client."),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"High-performance thanks to optimized handling of metadata (fewer network requests)"),Object(i.b)("li",{parentName:"ul"},"Developed fully ",Object(i.b)("em",{parentName:"li"},"In house")," and shares code with OData v4 client"),Object(i.b)("li",{parentName:"ul"},"Allows for faster feature development and bug fixes"),Object(i.b)("li",{parentName:"ul"},"Has standard and advanced APIs for typed and untyped client"),Object(i.b)("li",{parentName:"ul"},"More and better-implemented features")),Object(i.b)("h3",{id:"the-deprecated-old-client"},"The Deprecated Old Client"),Object(i.b)("p",null,"As of SAP Cloud SDK ",Object(i.b)("inlineCode",{parentName:"p"},"3.29.1")," we have deprecated the old OData client."),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"Stable and well tested"),Object(i.b)("li",{parentName:"ul"},"Based on 3rd party dependencies, which slows down the release of advanced features"),Object(i.b)("li",{parentName:"ul"},"Doesn't share a code base with OData v4 client"),Object(i.b)("li",{parentName:"ul"},"Has good performance, but not optimized for optimal metadata handling")),Object(i.b)("h3",{id:"which-one-to-choose"},"Which One to Choose?"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"We recommend using the new improved OData client for new development."),Object(i.b)("li",{parentName:"ul"},"For existing code, we recommend ",Object(i.b)("a",{parentName:"li",href:"#switch-to-improved-odata-vdm-beta"},"adjusting your code")," to switch to the new OData client.")),Object(i.b)("div",{className:"admonition admonition-tip alert alert--success"},Object(i.b)("div",{parentName:"div",className:"admonition-heading"},Object(i.b)("h5",{parentName:"div"},Object(i.b)("span",{parentName:"h5",className:"admonition-icon"},Object(i.b)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},Object(i.b)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"use Tabs to see the API difference")),Object(i.b)("div",{parentName:"div",className:"admonition-content"},Object(i.b)("p",{parentName:"div"},"Toggle between version Tabs in this document to see the API difference between these two OData v2 clients.\nWhere API is the same we provide a universal code snippet"))),Object(i.b)("h2",{id:"using-the-fluent-api"},"Using the Fluent API"),Object(i.b)("p",null,"The typed OData client consists of ",Object(i.b)("em",{parentName:"p"},"service")," and ",Object(i.b)("em",{parentName:"p"},"data model")," classes.\nThe service classes mirror the API provided by the OData service and serve as entry point for creating requests.\nThey provide a builder that allows for fluently adding further parameters."),Object(i.b)("p",null,"To execute HTTP requests the OData client leverages ",Object(i.b)("em",{parentName:"p"},"Destinations")," and are documented in more detail ",Object(i.b)("a",{parentName:"p",href:"../connectivity/sdk-connectivity-destination-service"},"here"),".\nThe following code snippets assume that such a destination is in place:"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-java"},"HttpDestination destination;\n")),Object(i.b)("p",null,"On an abstract level requests are generally build up according to the following pattern:"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-java"},"result = service.operation()\n    .withParameter(...)\n    .execute(destination);\n")),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("em",{parentName:"li"},"operation")," corresponds to the service's capabilities for entities e.g. ",Object(i.b)("inlineCode",{parentName:"li"},"createEntity")," or ",Object(i.b)("inlineCode",{parentName:"li"},"readEntities"),"."),Object(i.b)("li",{parentName:"ul"},Object(i.b)("em",{parentName:"li"},"withParameter")," corresponds to:",Object(i.b)("ul",{parentName:"li"},Object(i.b)("li",{parentName:"ul"},"OData query parameters e.g. ",Object(i.b)("inlineCode",{parentName:"li"},"filter")," or ",Object(i.b)("inlineCode",{parentName:"li"},"orderby")),Object(i.b)("li",{parentName:"ul"},"Or other modifiers like custom headers"))),Object(i.b)("li",{parentName:"ul"},"Which OData parameters are available depends on the operation.\nFor example, when updating entities the ",Object(i.b)("inlineCode",{parentName:"li"},"$filter")," parameter is not available.")),Object(i.b)("p",null,"Below different OData features are documented using the ",Object(i.b)("a",{parentName:"p",href:"https://api.sap.com/api/API_BUSINESS_PARTNER/resource"},"Business Partner Service")," on SAP S/4HANA as an example.\nIt is represented by the ",Object(i.b)("inlineCode",{parentName:"p"},"BusinessPartnerService")," class which is part of the pre-generated SAP S/4HANA Virtual Data Model (VDM). The following code snippets assume that an instance of this service is set up:"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-java"},"BusinessPartnerService service = new DefaultBusinessPartnerService();\n")),Object(i.b)("h2",{id:"odata-features"},"OData Features"),Object(i.b)("h3",{id:"basic-crud-operations"},"Basic CRUD Operations"),Object(i.b)("p",null,"Create, Read, Update and Delete operations on entities are build from the associated service class:"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-java"},'service.createBusinessPartner(partner);\nservice.getBusinessPartnerByKey("id");\nservice.getAllBusinessPartner();\nservice.updateBusinessPartner(partner);\nservice.deleteBusinessPartnerAddress(address);\n')),Object(i.b)("p",null,"Each of the above statements returns a builder object that allows for specifying certain request parameters, depending on the operation."),Object(i.b)("p",null,"The following query parameters and request options are available for these operations:"),Object(i.b)("p",null,"Query parameters:"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("inlineCode",{parentName:"li"},"$select")," and ",Object(i.b)("inlineCode",{parentName:"li"},"$expand")," are available on reading a single or multiple entities"),Object(i.b)("li",{parentName:"ul"},Object(i.b)("inlineCode",{parentName:"li"},"$filter"),", ",Object(i.b)("inlineCode",{parentName:"li"},"$top"),", ",Object(i.b)("inlineCode",{parentName:"li"},"$skip")," and ",Object(i.b)("inlineCode",{parentName:"li"},"$orderby")," are available only when reading a collection of entities")),Object(i.b)("p",null,"Request parameters:"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"All operations allow for adding custom headers via ",Object(i.b)("inlineCode",{parentName:"li"},"withHeader(...)")),Object(i.b)("li",{parentName:"ul"},"Update operations allow to set either ",Object(i.b)("inlineCode",{parentName:"li"},"modifyingEntity()")," or ",Object(i.b)("inlineCode",{parentName:"li"},"replacingEntity()")," which will result in ",Object(i.b)("inlineCode",{parentName:"li"},"HTTP PATCH")," or ",Object(i.b)("inlineCode",{parentName:"li"},"HTTP PUT")," respectively.\nBy default entities are modified via ",Object(i.b)("inlineCode",{parentName:"li"},"PATCH"),".")),Object(i.b)("h4",{id:"handling-of-etags"},"Handling of ETags"),Object(i.b)("p",null,"An ",Object(i.b)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/ETag"},"ETag")," is a version identifier that is often used to implement an optimistic locking mechanism.\nThe SAP Cloud SDK will try to read version identifiers from responses and set them when sending OData requests that manipulate data."),Object(i.b)("p",null,"Consider the following example:"),Object(i.b)(s.a,{groupId:"odataProtocol",defaultValue:"v2",values:[{label:"OData V2",value:"v2"},{label:"OData V2 (Deprecated)",value:"v2-deprecated"}],mdxType:"Tabs"},Object(i.b)(o.a,{value:"v2-deprecated",mdxType:"TabItem"},Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-java"},'partner = service.getBusinessPartnerByKey("id")\n                 .execute(destination);\nservice.updateBusinessPartner(partner)\n                 .execute(destination);\n// the partner object is updated automatically\n'))),Object(i.b)(o.a,{value:"v2",mdxType:"TabItem"},Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-java"},'partner = service.getBusinessPartnerByKey("id")\n                 .executeRequest(destination);\nresponse = service.updateBusinessPartner(partner)\n                 .executeRequest(destination);\n// update the partner reference\npartner = response.getModifiedEntity();\n')))),Object(i.b)("p",null,"On the read request, the SAP Cloud SDK will automatically try to extract the version identifier from the response and store it within the ",Object(i.b)("inlineCode",{parentName:"p"},"partner")," object.\nWhen updating it will be taken from there and sent with the ",Object(i.b)("inlineCode",{parentName:"p"},"If-match")," header."),Object(i.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(i.b)("div",{parentName:"div",className:"admonition-heading"},Object(i.b)("h5",{parentName:"div"},Object(i.b)("span",{parentName:"h5",className:"admonition-icon"},Object(i.b)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},Object(i.b)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),Object(i.b)("div",{parentName:"div",className:"admonition-content"},Object(i.b)("p",{parentName:"div"},"If a service requires this header to be sent: Fetching the entity from the service first is essential to ensure that the ETag is present and up to date."))),Object(i.b)("p",null,"This behavior can be customized.\nThe following code sends a ",Object(i.b)("inlineCode",{parentName:"p"},"*")," in the ",Object(i.b)("inlineCode",{parentName:"p"},"IF-MATCH")," header which essentially corresponds to a forced overwrite."),Object(i.b)(s.a,{groupId:"odataProtocol",defaultValue:"v2",values:[{label:"OData V2",value:"v2"},{label:"OData V2 (Deprecated)",value:"v2-deprecated"}],mdxType:"Tabs"},Object(i.b)(o.a,{value:"v2",mdxType:"TabItem"},Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-java"},"service.updateBusinessPartner(partner)\n                 .matchAnyVersionIdentifier()\n                 .executeRequest(destination);\n"))),Object(i.b)(o.a,{value:"v2-deprecated",mdxType:"TabItem"},Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-java"},"response = service.updateBusinessPartner(partner)\n                 .ignoreVersionIdentifier()\n                 .execute(destination);\n")))),Object(i.b)("h4",{id:"handling-of-cross-site-request-forgery-tokens"},"Handling of Cross-Site Request Forgery Tokens"),Object(i.b)("p",null,"For create, update and delete requests the SAP Cloud SDK will try to send a ",Object(i.b)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/Cross-site_request_forgery#Cookie-to-header_token"},"cross-site request forgery (CSRF) token"),".\nUpon execution, the request will try to fetch a token first before issuing the create request.\nMany services require this behavior for security reasons.\nHowever, the create request will be made without a CSRF token if none could be obtained."),Object(i.b)("h3",{id:"select"},"Select"),Object(i.b)("p",null,"When reading entities the API offers ",Object(i.b)("inlineCode",{parentName:"p"},"select( ... )")," on the builders.\nThrough it, the query parameters ",Object(i.b)("inlineCode",{parentName:"p"},"$select")," and ",Object(i.b)("inlineCode",{parentName:"p"},"$expand")," are set.\nIt takes in the properties of the entity being queried.\nPrimitive properties are added to ",Object(i.b)("inlineCode",{parentName:"p"},"$select")," while complex and navigational properties are added to ",Object(i.b)("inlineCode",{parentName:"p"},"$expand"),".\nThis handling is done automatically by the SAP Cloud SDK."),Object(i.b)("p",null,"The properties that can be selected or expanded are represented via static ",Object(i.b)("em",{parentName:"p"},"fields on the entity")," class.\nThere will be a field for each property.\nE.g. for the business partner entity one can find ",Object(i.b)("inlineCode",{parentName:"p"},"BusinessPartner.FIRST_NAME")," and ",Object(i.b)("inlineCode",{parentName:"p"},"BusinessPartner.LAST_NAME"),"."),Object(i.b)(s.a,{groupId:"odataProtocol",defaultValue:"v2",values:[{label:"OData V2",value:"v2"},{label:"OData V2 (Deprecated)",value:"v2-deprecated"}],mdxType:"Tabs"},Object(i.b)(o.a,{value:"v2-deprecated",mdxType:"TabItem"},Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-java"},'service.getBusinessPartnerByKey("id")\n    .select(BusinessPartner.FIRST_NAME, BusinessPartner.LAST_NAME, BusinessPartner.TO_BUSINESS_PARTNER_ADDRESS)\n    .execute(destination);\n')),Object(i.b)("p",null,"The above translates to the following query parameters:"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre"},"$select=FirstName,LastName,to_BusinessPartnerAddress/*&$expand=to_BusinessPartnerAddress\n")),Object(i.b)("p",null,"One can also apply select again to the expanded object:"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-java"},'service.getBusinessPartnerByKey("id")\n    .select(BusinessPartner.FIRST_NAME,\n        BusinessPartner.TO_BUSINESS_PARTNER_ADDRESS\n            .select(BusinessPartnerAddress.ADDRESS_ID,\n                BusinessPartnerAddress.CITY_CODE))\n    .execute(destination);\n')),Object(i.b)("p",null,"The above translates to the following query parameters:"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre"},"$select=FirstName,to_BusinessPartnerAddress/AddressID,to_BusinessPartnerAddress/CityCode&$expand=to_BusinessPartnerAddress\n"))),Object(i.b)(o.a,{value:"v2",mdxType:"TabItem"},Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-java"},'service.getBusinessPartnerByKey("id")\n    .select(BusinessPartner.FIRST_NAME, BusinessPartner.LAST_NAME, BusinessPartner.TO_BUSINESS_PARTNER_ADDRESS)\n    .executeRequest(destination);\n')),Object(i.b)("p",null,"The above translates to the following query parameters:"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre"},"$select=FirstName,LastName,to_BusinessPartnerAddress/*&$expand=to_BusinessPartnerAddress\n")),Object(i.b)("p",null,"One can also apply select again to the expanded object:"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-java"},'service.getBusinessPartnerByKey("id")\n    .select(BusinessPartner.FIRST_NAME,\n        BusinessPartner.TO_BUSINESS_PARTNER_ADDRESS\n            .select(BusinessPartnerAddress.ADDRESS_ID,\n                BusinessPartnerAddress.CITY_CODE))\n    .executeRequest(destination);\n')),Object(i.b)("p",null,"The above translates to the following query parameters:"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre"},"$select=FirstName,to_BusinessPartnerAddress/AddressID,to_BusinessPartnerAddress/CityCode&$expand=to_BusinessPartnerAddress\n")))),Object(i.b)("h3",{id:"filter"},"Filter"),Object(i.b)("p",null,"When operating on a collection of entities the API offers ",Object(i.b)("inlineCode",{parentName:"p"},"filter( ... )")," on the builders.\nIt directly corresponds to the ",Object(i.b)("inlineCode",{parentName:"p"},"$filter")," parameter of the request.\nFilters are also built via the static property fields on entities."),Object(i.b)("p",null,"The following example:"),Object(i.b)(s.a,{groupId:"odataProtocol",defaultValue:"v2",values:[{label:"OData V2",value:"v2"},{label:"OData V2 (Deprecated)",value:"v2-deprecated"}],mdxType:"Tabs"},Object(i.b)(o.a,{value:"v2-deprecated",mdxType:"TabItem"},Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-java"},"/*\nGet all business partners that either:\n  - Have first name 'Alice' but not last name 'Bob'\n  - Or have first name 'Mallory'\n*/\nservice.getAllBusinessPartner()\n    .filter(BusinessPartner.FIRST_NAME.eq(\"Alice\")\n        .and(BusinessPartner.LAST_NAME.ne(\"Bob\"))\n        .or(BusinessPartner.FIRST_NAME.eq(\"Mallory\"))\n    )\n    .execute(destination);\n"))),Object(i.b)(o.a,{value:"v2",mdxType:"TabItem"},Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-java"},"/*\nGet all business partners that either:\n  - Have first name 'Alice' but not last name 'Bob'\n  - Or have first name 'Mallory'\n*/\nservice.getAllBusinessPartner()\n    .filter(BusinessPartner.FIRST_NAME.eq(\"Alice\")\n        .and(BusinessPartner.LAST_NAME.ne(\"Bob\"))\n        .or(BusinessPartner.FIRST_NAME.eq(\"Mallory\"))\n    )\n    .executeRequest(destination);\n")))),Object(i.b)("p",null,"Will translate to this filter parameter:"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre"},"$filter=(((FirstName eq 'Alice') and (LastName ne 'Bob')) or (FirstName eq 'Mallory'))\n")),Object(i.b)("p",null,"Take note of the order of ",Object(i.b)("inlineCode",{parentName:"p"},"and")," and ",Object(i.b)("inlineCode",{parentName:"p"},"or"),".\nAs ",Object(i.b)("inlineCode",{parentName:"p"},"or")," is invoked on the result of ",Object(i.b)("inlineCode",{parentName:"p"},"and")," it will form the outer expression while ",Object(i.b)("inlineCode",{parentName:"p"},"and")," is an inner expression in the first branch of ",Object(i.b)("inlineCode",{parentName:"p"},"or"),"."),Object(i.b)("p",null,"To achieve a different order with ",Object(i.b)("inlineCode",{parentName:"p"},"and")," as the top level statement one would nest the ",Object(i.b)("inlineCode",{parentName:"p"},"or")," within ",Object(i.b)("inlineCode",{parentName:"p"},"and(...)"),":"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-java"},'.and(BusinessPartner.LAST_NAME.ne("Bob")\n    .or(BusinessPartner.FIRST_NAME.eq("Mallory"))\n)\n')),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-java"},'.and(BusinessPartner.LAST_NAME.ne("Bob")\n    .or(BusinessPartner.FIRST_NAME.eq("Mallory"))\n)\n')),Object(i.b)("h4",{id:"available-filter-expressions"},"Available Filter Expressions"),Object(i.b)("p",null,"The ",Object(i.b)("a",{parentName:"p",href:"https://www.odata.org/documentation/odata-version-2-0/uri-conventions/"},"OData v2 standard")," allows for a limited range of filter expressions compared to OData v4.\nA detailed list of what is available in the SAP Cloud SDK can be obtained from ",Object(i.b)("a",{parentName:"p",href:"https://help.sap.com/doc/b579bf8578954412aea2b458e8452201/1.0/en-US/com/sap/cloud/sdk/datamodel/odata/helper/package-summary.html"},"the Javadoc"),".\nThe functionality can also be discovered through the fluent API."),Object(i.b)("h3",{id:"batch-requests"},"Batch Requests"),Object(i.b)("p",null,"Batch requests allow wrapping multiple OData requests into one single batch call.\nThereby we reduce the number of round trips to the remote server.\nRefer to the ",Object(i.b)("a",{parentName:"p",href:"https://www.odata.org/documentation/odata-version-2-0/batch-processing/"},"official OData V2 spec")," for further reference about batch requests, their semantics, and the request/response format."),Object(i.b)("h4",{id:"execute-batch-request"},"Execute Batch Request"),Object(i.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(i.b)("div",{parentName:"div",className:"admonition-heading"},Object(i.b)("h5",{parentName:"div"},Object(i.b)("span",{parentName:"h5",className:"admonition-icon"},Object(i.b)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},Object(i.b)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"OData Read request")),Object(i.b)("div",{parentName:"div",className:"admonition-content"},Object(i.b)("p",{parentName:"div"},"At the moment we do not provide type-safe API for adding OData Read requests to Batch.\nYou can work around it for now with generic ",Object(i.b)("a",{parentName:"p",href:"/cloud-sdk/docs/java/features/odata/generic-untyped-odata-client#odata-v2-batch-read-request"},"OData Client"),"."))),Object(i.b)("p",null,"The ",Object(i.b)("inlineCode",{parentName:"p"},"service")," object offers the method ",Object(i.b)("inlineCode",{parentName:"p"},"batch")," which allows access to the batch-related methods that help build the batch request."),Object(i.b)("p",null,"Multiple single requests (like ",Object(i.b)("inlineCode",{parentName:"p"},"createBusinessPartnerAddress"),") can be wrapped into so-called changesets.\nEach changeset is opened with ",Object(i.b)("inlineCode",{parentName:"p"},"beginChangeSet")," and closed with ",Object(i.b)("inlineCode",{parentName:"p"},"endChangeSet"),". You can wrap multiple changesets into one batch request."),Object(i.b)("p",null,"Non-modification or in other words Read requests can be added outside of changesets with the ",Object(i.b)("inlineCode",{parentName:"p"},"addReadOperations")," method."),Object(i.b)("p",null,"Use ",Object(i.b)("inlineCode",{parentName:"p"},"executeRequest")," to issue the batch request to the remote system.\nWe receive an instance of ",Object(i.b)("inlineCode",{parentName:"p"},"BatchResponse")," as the result object."),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-java"},'BusinessPartnerAddress addressToCreate1;\nBusinessPartnerAddress addressToCreate2;\n\nBusinessPartnerFluentHelper requestTenEntities = service.getAllBusinessPartner().top(10);\nBusinessPartnerByKeyFluentHelper requestSingleEntity = service.getBusinessPartnerByKey("bupa9000");\n\nBatchResponse result =\n    service\n        .batch()\n        .beginChangeSet()\n        .createBusinessPartnerAddress(addressToCreate1)\n        .createBusinessPartnerAddress(addressToCreate2)\n        .endChangeSet()\n        .addReadOperations(requestTenEntities)\n        .addReadOperations(requestSingleEntity)\n        .executeRequest(destination);\n')),Object(i.b)("h4",{id:"access-batch-response"},"Access Batch Response"),Object(i.b)("p",null,"In OData Batch, the response is structured similarly to the request.\nThe unordered responses of data modification requests are accessible with a given changeset index.\nThe ordered responses of data retrieval requests are accessible with the reference of the original request object."),Object(i.b)("h5",{id:"changeset-response"},"Changeset Response"),Object(i.b)("p",null,"Use the method ",Object(i.b)("inlineCode",{parentName:"p"},"get")," to access the individual changeset responses by index."),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-java"},"Try<BatchResponseChangeSet> changeSetTry = result.get(0);\n")),Object(i.b)("p",null,"The returned ",Object(i.b)("inlineCode",{parentName:"p"},"Try")," allows checking if the respective changeset was processed successfully by the remote server.\nPer the specification, either all operations or none within the same changeset are successful.\nHence, if ",Object(i.b)("inlineCode",{parentName:"p"},"changeSetTry.isSuccess()")," is true, you can derive that all operations in the changeset are successful."),Object(i.b)("p",null,"In case the changeset contained at least one create operation, you can gain access to the created entity representations by using the method ",Object(i.b)("inlineCode",{parentName:"p"},"getCreatedEntities"),"."),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-java"},"if (changeSetTry.isSuccess()) {\n    //now you can access the created entities\n    final List<VdmEntity<?>> createdEntities = changeSet.get().getCreatedEntities();\n}\n")),Object(i.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(i.b)("div",{parentName:"div",className:"admonition-heading"},Object(i.b)("h5",{parentName:"div"},Object(i.b)("span",{parentName:"h5",className:"admonition-icon"},Object(i.b)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},Object(i.b)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),Object(i.b)("div",{parentName:"div",className:"admonition-content"},Object(i.b)("p",{parentName:"div"},"You have to cast the entity representations from the generic type ",Object(i.b)("inlineCode",{parentName:"p"},"VdmEntity")," to the respective subclasses."))),Object(i.b)("h5",{id:"read-response"},"Read Response"),Object(i.b)("p",null,"Use the method ",Object(i.b)("inlineCode",{parentName:"p"},"getReadResult")," to extract the deserialized response of a given read operation:"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-java"},"List<BusinessPartner> entities = result.getReadResult(requestTenEntities);\nBusinessPartner entity = result.getReadResult(requestSingleEntity);\n")),Object(i.b)("p",null,"Instead of an index to indicate the batch position, the API expects the original request reference.\nThe request-response mapping and deserialization are happening internally."),Object(i.b)("h2",{id:"entity-update-strategies"},"Entity Update Strategies"),Object(i.b)("p",null,"The SAP Cloud SDK supports different strategies for updating entities which differ in the HTTP method and the payload of the update request."),Object(i.b)("div",{className:"admonition admonition-info alert alert--info"},Object(i.b)("div",{parentName:"div",className:"admonition-heading"},Object(i.b)("h5",{parentName:"div"},Object(i.b)("span",{parentName:"h5",className:"admonition-icon"},Object(i.b)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},Object(i.b)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),Object(i.b)("div",{parentName:"div",className:"admonition-content"},Object(i.b)("p",{parentName:"div"},"To update an entity it should first be retrieved from the service.\nThis ensures the latest state of the entity is updated.\nOtherwise updating with old data could erase changes that have been made to the entity in the mean time.\nMany services will enforce this behaviour with optimistic locking mechanisms.\nRefer to the ",Object(i.b)("a",{parentName:"p",href:"#handling-of-etags"},"section about ETags for details"),"."))),Object(i.b)(s.a,{groupId:"updateStrategy",defaultValue:"modify",values:[{label:"Modify Entity (default)",value:"modify"},{label:"Replace Entity",value:"replace"}],mdxType:"Tabs"},Object(i.b)(o.a,{value:"modify",mdxType:"TabItem"},Object(i.b)("p",null,"The default strategy is the ",Object(i.b)("em",{parentName:"p"},"modifying entity update strategy")," which attempts to modify only the necessary entity fields in the remote system.\nIt issues a PATCH request and includes only the fields in the request payload whose values were ",Object(i.b)("em",{parentName:"p"},"changed by its setter method"),".\nHence, fields whose values remain unchanged are not sent to the target system.\nCalling the method ",Object(i.b)("inlineCode",{parentName:"p"},"includingFields(fields ...)")," instructs the SAP Cloud SDK to add the mentioned fields explicitly in the update request.\nThis is useful for backend systems that require some unchanged fields in the request payload for given reasons."),Object(i.b)("p",null,"This update strategy can be explicitly chosen by invoking the method ",Object(i.b)("inlineCode",{parentName:"p"},"modifyingEntity()")," while building the update request."),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-java"},"service.updateBusinessPartner(partner)\n    //method call optional, since active by default\n    .modifyingEntity()\n    //add the Business Partner Full Name explicitly to the update request\n    .includingFields(BusinessPartner.BUSINESS_PARTNER_FULL_NAME)\n    .executeRequest(destination);\n"))),Object(i.b)(o.a,{value:"replace",mdxType:"TabItem"},Object(i.b)("p",null,"The ",Object(i.b)("em",{parentName:"p"},"replacing entity update strategy")," attempts to replace the full entity in the remote system.\nIt issues a PUT request and submits all fields in the update request, regardless of any field changes."),Object(i.b)("p",null,"This update strategy can be explicitly chosen invoking the method ",Object(i.b)("inlineCode",{parentName:"p"},"replacingEntity()")," while building the update request."),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-java"},"service.updateBusinessPartner(partner)\n    .replacingEntity()\n    .executeRequest(destination);\n")))),Object(i.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(i.b)("div",{parentName:"div",className:"admonition-heading"},Object(i.b)("h5",{parentName:"div"},Object(i.b)("span",{parentName:"h5",className:"admonition-icon"},Object(i.b)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},Object(i.b)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),Object(i.b)("div",{parentName:"div",className:"admonition-content"},Object(i.b)("p",{parentName:"div"},"It depends on the capabilities of the specific OData service in the remote system which update strategies are supported in an end-to-end scenario.\nFor example, there are cases where OData services do not support PUT requests."))),Object(i.b)("h2",{id:"error-handling"},"Error Handling"),Object(i.b)(s.a,{groupId:"odataProtocol",defaultValue:"v2",values:[{label:"OData V2",value:"v2"},{label:"OData V2 (Deprecated)",value:"v2-deprecated"}],mdxType:"Tabs"},Object(i.b)(o.a,{value:"v2-deprecated",mdxType:"TabItem"},Object(i.b)("p",null,"Coming soon.")),Object(i.b)(o.a,{value:"v2",mdxType:"TabItem"},Object(i.b)("p",null,"Sometimes requests fail and the SAP Cloud SDK provides a flexible way to deal with such failures on multiple levels.\nAll ",Object(i.b)("inlineCode",{parentName:"p"},"executeRequest")," methods may throw a runtime exception (extending) ",Object(i.b)("inlineCode",{parentName:"p"},"ODataException"),".\nThis will always contain the request which was (attempted to be) sent out as well as the cause of the exception.\nTo handle all kind of failures consider the following code:"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-java"},'try { ... }\n catch( final ODataException e ) {\n    ODataQueryGeneric query = e.getQuery();\n    logger.debug("The following query failed: {}", query);\n    // do something else\n}\n')),Object(i.b)("p",null,"This handling is the most generic, handling all possible failures.\nFor more specific information dedicated exceptions are inheriting from ",Object(i.b)("inlineCode",{parentName:"p"},"ODataException"),".\nPlease check the ",Object(i.b)("a",{parentName:"p",href:"https://help.sap.com/doc/b579bf8578954412aea2b458e8452201/1.0/en-US/com/sap/cloud/sdk/datamodel/odata/client/exception/ODataException.html"},"documentation")," for details on all the exception types."),Object(i.b)("p",null,"To handle different kinds of failure one can list multiple catch clauses to cover different levels or cases that might occur, e.g.:"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-java"},'try { ... }\ncatch( ODataServiceErrorException e ) {\n    // handle the specific error message from the response payload\n    ODataServiceError odataError = e.getODataError();\n    logger.debug("The OData service responded with an error: {}", odataError);\n} catch( ODataDeserializationException e ) {\n    // handle failures in deserialization\n} catch( ODataResponseException e ) {\n    // handle all other errors originating from handling the HTTP response\n    int httpCode = e.getHttpCode();\n    Collection<Header> httpCode = e.getHttpHeaders();\n    Option<String> httpBody = e.getHttpBody();\n}\n')))),Object(i.b)("h2",{id:"navigation-properties"},"Navigation Properties"),Object(i.b)("p",null,"A navigation property describes a unidirectional relationship between two entity types.\nLike other properties, it has a name and declares a multiplicity, i.e. whether to expect a single or multiple values.\nAdditionally, a navigation property allows for dedicated CRUD operations, that may not be exposed by default on entity sets of the service root.\nSuch operations also provide a convenient way to access the nested resources of entities."),Object(i.b)(s.a,{groupId:"odataProtocol",defaultValue:"v2",values:[{label:"OData V2",value:"v2"},{label:"OData V2 (Deprecated)",value:"v2-deprecated"}],mdxType:"Tabs"},Object(i.b)(o.a,{value:"v2-deprecated",mdxType:"TabItem"},Object(i.b)("p",null,"The typed OData client for OData v2 supports the following operations on (first-level only) navigation properties:"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"Create")),Object(i.b)("p",null,"The below example leverages the creation of a nested entity in relation to an existing entity:"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-java"},'/*\nCreate a new address for a specific business partner.\n*/\nBusinessPartner businessPartnerById = BusinessPartner.builder().businessPartner("123").build();\nBusinessPartnerAddress addressItem = BusinessPartnerAddress.builder().country("DE").build();\n\nservice.createBusinessPartnerAddress( addressItem )\n    .asChildOf( businessPartnerById, BusinessPartner.TO_BUSINESS_PARTNER_ADDRESS )\n    .execute( destination );\n')),Object(i.b)("p",null,"This sample API call translates to the following service request:"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre"},'POST /ODataService/API_BUSINESS_PARTNER/A_BusinessPartner(123)/to_BusinessPartnerAddress\n{\n  "country": "de"\n}\n'))),Object(i.b)(o.a,{value:"v2",mdxType:"TabItem"},Object(i.b)("p",null,"The typed OData client for OData v2 supports the following operations on (first-level only) navigation properties:"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"Create")),Object(i.b)("p",null,"The below example leverages the creation of a nested entity in relation to an existing entity:"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-java"},'/*\nCreate a new address for a specific business partner.\n*/\nBusinessPartner businessPartnerById = BusinessPartner.builder().businessPartner("123").build();\nBusinessPartnerAddress addressItem = BusinessPartnerAddress.builder().country("DE").build();\n\nservice.createBusinessPartnerAddress( addressItem )\n    .asChildOf( businessPartnerById, BusinessPartner.TO_BUSINESS_PARTNER_ADDRESS )\n    .executeRequest( destination );\n')),Object(i.b)("p",null,"This sample API call translates to the following service request:"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre"},'POST /ODataService/API_BUSINESS_PARTNER/A_BusinessPartner(123)/to_BusinessPartnerAddress\n{\n  "country": "de"\n}\n')))),Object(i.b)("h2",{id:"server-driven-paging"},"Server-Driven Paging"),Object(i.b)("p",null,"Pagination describes the practice of splitting a collection of entities from reading requests into one or many pages.\nThe paging behavior is determined by both the server and the client."),Object(i.b)("p",null,"OData service operators may decide to enable server-driven pagination to limit the amount of data that is fetched and sent over the network to the client, in case generic query options yield huge amounts of data.\nBy splitting the result-set into sequential pages of entities, the data can be requested incrementally.\nThis reduces initial network load and improves overall response times.\nIf the payload of an OData response contains a link including a ",Object(i.b)("inlineCode",{parentName:"p"},"$skiptoken"),", then it indicates a next page to the result-set.\nThe iterable result-set is a consistent snapshot of the data, it can not change between reading individual pages."),Object(i.b)("p",null,"In comparison the OData consumer may use query options ",Object(i.b)("inlineCode",{parentName:"p"},"$top")," and ",Object(i.b)("inlineCode",{parentName:"p"},"$skip")," (client-driven paging) to read partial data from the result-set, but relying on a consistent state while browsing through the data can be problematic.\nBetween individual requests, another user could delete or add an item.\nThis would result in an inconsistent aggregation of data."),Object(i.b)("p",null,"By default, the SAP Cloud SDK automatically resolves all pages of a result-set if server-driven paging is encountered.\nFor the API consumer, it is not necessary to parse the next link and instantiate follow-up requests to aggregate the full result-set."),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-java"},"List<BusinessPartner> iterablePagesOfEntities = service\n  .getAllBusinessPartner()\n  .executeRequest( destination );\n")),Object(i.b)("p",null,"In case memory efficiency and response time of the consuming application becomes a priority, then the advanced API provides additional means to manually iterate through the internal pages.\nWhile accessing the following methods, the internal HTTP requests are executed lazily:"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-java"},"Iterable<List<BusinessPartner>> iterablePagesOfEntities = service\n  .getAllBusinessPartner()\n  .iteratingPages()\n  .executeRequest( destination );\n\nIterable<BusinessPartner> iterableEntities = service\n  .getAllBusinessPartner()\n  .iteratingEntities()\n  .executeRequest(destination);\n\nStream<BusinessPartner> streamingEntities = service\n  .getAllBusinessPartner()\n  .streamingEntities()\n  .executeRequest(destination);\n")),Object(i.b)("p",null,"The request builder allows for setting the optional parameter for preferred page size.\nPlease note that the OData service is not obliged to respect this setting."),Object(i.b)("h2",{id:"switch-to-improved-odata-v2-type-safe-client"},"Switch to Improved OData v2 Type-Safe Client"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"For any operation type, replace a call to ",Object(i.b)("inlineCode",{parentName:"li"},"execute")," with ",Object(i.b)("inlineCode",{parentName:"li"},"executeRequest"),".")),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-java"},"service.createBusinessPartner(partner).executeRequest(destination);\n")),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"For ",Object(i.b)("em",{parentName:"li"},"Create")," and ",Object(i.b)("em",{parentName:"li"},"Update")," operations, call ",Object(i.b)("inlineCode",{parentName:"li"},"getModifiedEntity()")," to obtain the created entity representation.")),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-java"},"final BusinessPartner partner = service.createBusinessPartner(partner)\n                                       .executeRequest(destination)\n                                       .getModifiedEntity();\n")),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("inlineCode",{parentName:"li"},"executeRequest")," throws the runtime exception ",Object(i.b)("inlineCode",{parentName:"li"},"ODataException")," and respective sub classes.\nHence, adjust your exception handling as described under the tab ",Object(i.b)("em",{parentName:"li"},"OData V2 (Beta)")," in the section ",Object(i.b)("a",{parentName:"li",href:"#error-handling"},"Error Handling"),".\nNote that any ",Object(i.b)("inlineCode",{parentName:"li"},"ErrorResultHandler")," registered by ",Object(i.b)("inlineCode",{parentName:"li"},"withErrorHandler()")," is not considered."),Object(i.b)("li",{parentName:"ul"},"Remove any call to ",Object(i.b)("inlineCode",{parentName:"li"},"cachingMetadata()")," and ",Object(i.b)("inlineCode",{parentName:"li"},"withoutCachingMetadata()")," as they are obsolete."),Object(i.b)("li",{parentName:"ul"},"Remove any call to ",Object(i.b)("inlineCode",{parentName:"li"},"ignoringVersionIdentifier(boolean)")," or ",Object(i.b)("inlineCode",{parentName:"li"},"ignoreVersionIdentifier()"),". Use ",Object(i.b)("inlineCode",{parentName:"li"},"matchAnyVersionIdentifier()")," or ",Object(i.b)("inlineCode",{parentName:"li"},"disableVersionIdentifier()")," instead.")))}p.isMDXComponent=!0},214:function(e,t,a){"use strict";a.d(t,"a",(function(){return b})),a.d(t,"b",(function(){return h}));var n=a(0),r=a.n(n);function i(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function s(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?s(Object(a),!0).forEach((function(t){i(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):s(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var c=r.a.createContext({}),d=function(e){var t=r.a.useContext(c),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},b=function(e){var t=d(e.components);return r.a.createElement(c.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},u=r.a.forwardRef((function(e,t){var a=e.components,n=e.mdxType,i=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),b=d(a),u=n,h=b["".concat(s,".").concat(u)]||b[u]||p[u]||i;return a?r.a.createElement(h,o(o({ref:t},c),{},{components:a})):r.a.createElement(h,o({ref:t},c))}));function h(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var i=a.length,s=new Array(i);s[0]=u;var o={};for(var l in t)hasOwnProperty.call(t,l)&&(o[l]=t[l]);o.originalType=e,o.mdxType="string"==typeof e?e:n,s[1]=o;for(var c=2;c<i;c++)s[c]=a[c];return r.a.createElement.apply(null,s)}return r.a.createElement.apply(null,a)}u.displayName="MDXCreateElement"},215:function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return s}));var n=a(16),r=a(216);function i(){var e=Object(n.default)().siteConfig,t=(e=void 0===e?{}:e).baseUrl,a=void 0===t?"/":t,i=e.url;return{withBaseUrl:function(e,t){return function(e,t,a,n){var i=void 0===n?{}:n,s=i.forcePrependBaseUrl,o=void 0!==s&&s,l=i.absolute,c=void 0!==l&&l;if(!a)return a;if(a.startsWith("#"))return a;if(Object(r.b)(a))return a;if(o)return t+a;var d=a.startsWith(t)?a:t+a.replace(/^\//,"");return c?e+d:d}(i,a,e,t)}}}function s(e,t){return void 0===t&&(t={}),(0,i().withBaseUrl)(e,t)}},216:function(e,t,a){"use strict";function n(e){return!0===/^(\w*:|\/\/)/.test(e)}function r(e){return void 0!==e&&!n(e)}a.d(t,"b",(function(){return n})),a.d(t,"a",(function(){return r}))},217:function(e,t,a){"use strict";function n(e){var t,a,r="";if("string"==typeof e||"number"==typeof e)r+=e;else if("object"==typeof e)if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(a=n(e[t]))&&(r&&(r+=" "),r+=a);else for(t in e)e[t]&&(r&&(r+=" "),r+=t);return r}t.a=function(){for(var e,t,a=0,r="";a<arguments.length;)(e=arguments[a++])&&(t=n(e))&&(r&&(r+=" "),r+=t);return r}},219:function(e,t,a){"use strict";var n=a(0),r=a(220);t.a=function(){var e=Object(n.useContext)(r.a);if(null==e)throw new Error("`useUserPreferencesContext` is used outside of `Layout` Component.");return e}},220:function(e,t,a){"use strict";var n=a(0),r=Object(n.createContext)(void 0);t.a=r},222:function(e,t,a){"use strict";var n=a(0),r=a.n(n),i=a(219),s=a(217),o=a(56),l=a.n(o);var c=37,d=39;t.a=function(e){var t=e.lazy,a=e.block,o=e.defaultValue,b=e.values,p=e.groupId,u=e.className,h=Object(i.a)(),m=h.tabGroupChoices,v=h.setTabGroupChoices,O=Object(n.useState)(o),j=O[0],f=O[1],g=n.Children.toArray(e.children),y=[];if(null!=p){var N=m[p];null!=N&&N!==j&&b.some((function(e){return e.value===N}))&&f(N)}var w=function(e){var t=e.target,a=y.indexOf(t),n=g[a].props.value;f(n),null!=p&&(v(p,n),setTimeout((function(){var e,a,n,r,i,s,o,c;(e=t.getBoundingClientRect(),a=e.top,n=e.left,r=e.bottom,i=e.right,s=window,o=s.innerHeight,c=s.innerWidth,a>=0&&i<=c&&r<=o&&n>=0)||(t.scrollIntoView({block:"center",behavior:"smooth"}),t.classList.add(l.a.tabItemActive),setTimeout((function(){return t.classList.remove(l.a.tabItemActive)}),2e3))}),150))},T=function(e){var t,a;switch(e.keyCode){case d:var n=y.indexOf(e.target)+1;a=y[n]||y[0];break;case c:var r=y.indexOf(e.target)-1;a=y[r]||y[y.length-1]}null===(t=a)||void 0===t||t.focus()};return r.a.createElement("div",{className:"tabs-container"},r.a.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:Object(s.a)("tabs",{"tabs--block":a},u)},b.map((function(e){var t=e.value,a=e.label;return r.a.createElement("li",{role:"tab",tabIndex:j===t?0:-1,"aria-selected":j===t,className:Object(s.a)("tabs__item",l.a.tabItem,{"tabs__item--active":j===t}),key:t,ref:function(e){return y.push(e)},onKeyDown:T,onFocus:w,onClick:w},a)}))),t?Object(n.cloneElement)(g.filter((function(e){return e.props.value===j}))[0],{className:"margin-vert--md"}):r.a.createElement("div",{className:"margin-vert--md"},g.map((function(e,t){return Object(n.cloneElement)(e,{key:t,hidden:e.props.value!==j})}))))}},223:function(e,t,a){"use strict";var n=a(0),r=a.n(n);t.a=function(e){var t=e.children,a=e.hidden,n=e.className;return r.a.createElement("div",{role:"tabpanel",hidden:a,className:n},t)}}}]);